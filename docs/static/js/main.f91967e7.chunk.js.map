{"version":3,"sources":["components/molecules/FaceEditor.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["FaceEditor","props","editor","state","image","scale","died","handleDiedCheck","bind","handleNewImage","handleDeleteImage","handleScale","React","createRef","this","setState","e","target","files","parseFloat","value","current","getImage","ex","getImageScaledToCanvas","canvas","className","ref","width","height","border","type","checked","onChange","accept","onClick","step","min","max","Component","COPYRIGHT","App","canvasPreview","ctxPreview","canvasFace","ctxFace","canvasTitle","ctxTitle","startTime","prevFadeRatio","frameStartTime","gifjs","dlImage","document","createElement","length","length_text","title","previewing","canDL","downloadUrl","fileName","recording","showCopyright","editors","Array","from","map","_","handleMemberLengthChange","handleChangeTitle","handleClickPreview","handleChangeCopyright","animate","querySelector","getContext","k","key","toString","parseInt","isNaN","slice","i","push","drawFaceList","drawTitle","GIF","workerScript","quality","workers","Date","getTime","requestAnimationFrame","now","delay","addFrame","copy","me","on","blob","url","URL","createObjectURL","src","render","elapsed","MSEC_BEFORE","saveGif","fadeRatio","MSEC_WHOLE","x","calculateFadeRatio","drawFrame","fillStyle","fillRect","globalAlpha","drawImage","ratio","w","h","y","getFace","faces","_y","CANVAS_HEIGHT","create","ret","unshift","getFaceCanvases","pos","calculatePosition","c","p","img","getImageData","data","v","grayscale","putImageData","drawCopyright","lineJoin","miterLimit","font","textAlign","lineWidth","strokeStyle","strokeText","CANVAS_WIDTH","fillText","fontSize","ctx","Math","floor","getFont","measureText","getTitle","getTextSize","htmlFor","id","String","placeholder","faceListClass","faceList","disabled","style","display","href","download","Boolean","window","location","hostname","match","ReactDOM","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.f91967e7.chunk.js","sourcesContent":["import React from 'react';\nimport './FaceEditor.css';\nimport AvatarEditor from 'react-avatar-editor';\n\ntype FaceEditorProps = {\n  image?: string | File;\n  width: number;\n  height: number;\n};\n\ntype FaceEditorState = {\n  image: string | File;\n  scale: number;\n  died: boolean;\n};\n\nexport type Face = {\n  canvas: HTMLCanvasElement | null;\n  died: boolean;\n};\n\nclass FaceEditor extends React.Component<FaceEditorProps, FaceEditorState> {\n  private editor: React.RefObject<AvatarEditor>;\n\n  constructor(props: FaceEditorProps) {\n    super(props);\n    this.state = {\n      image: this.props.image || '',\n      scale: 1,\n      died: false,\n    };\n    this.handleDiedCheck = this.handleDiedCheck.bind(this);\n    this.handleNewImage = this.handleNewImage.bind(this);\n    this.handleDeleteImage = this.handleDeleteImage.bind(this);\n    this.handleScale = this.handleScale.bind(this);\n    this.editor = React.createRef<AvatarEditor>();\n  }\n\n  handleDiedCheck(): void {\n    this.setState((state) => ({ died: !state.died }));\n  }\n\n  handleNewImage(e: React.ChangeEvent<HTMLInputElement>): void {\n    if (!e.target) return;\n    const input = e.target as HTMLInputElement;\n    const files = input.files;\n    if (!files) return;\n    this.setState({ image: files[0] });\n  }\n\n  handleDeleteImage(): void {\n    this.setState({ image: '' });\n  }\n\n  handleScale(e: React.ChangeEvent<HTMLInputElement>): void {\n    const scale = parseFloat(e.target.value);\n    this.setState({ scale });\n  }\n\n  public getImage(): HTMLCanvasElement | null {\n    if (!this.editor.current) return null;\n    try {\n      return this.editor.current.getImage();\n    } catch (ex) {\n      return null;\n    }\n  }\n\n  public getImageScaledToCanvas(): HTMLCanvasElement | null {\n    if (!this.editor.current) return null;\n    try {\n      return this.editor.current.getImageScaledToCanvas();\n    } catch (ex) {\n      return null;\n    }\n  }\n\n  public getFace(): Face {\n    return {\n      canvas: this.editor.current?.getImageScaledToCanvas() || null,\n      died: this.state.died,\n    };\n  }\n\n  render() {\n    return (\n      <div className=\"FaceEditor\">\n        <AvatarEditor\n          ref={this.editor}\n          className={\n            'FaceEditor-Canvas' + (this.state.died ? ' FaceEditor-Died' : '')\n          }\n          image={this.state.image}\n          scale={this.state.scale}\n          width={this.props.width}\n          height={this.props.height}\n          border={0}\n        />\n        <div className=\"FaceEditor-Controls FaceEditor-Controls-Top\">\n          <label>\n            <input\n              className=\"FaceEditor-Controls-Died\"\n              type=\"checkbox\"\n              checked={this.state.died}\n              onChange={this.handleDiedCheck}\n            />\n            死\n          </label>\n          <label>\n            画像\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={this.handleNewImage}\n            />\n          </label>\n          <label\n            className=\"FaceEditor-Controls-Delete\"\n            onClick={this.handleDeleteImage}\n          >\n            ×\n          </label>\n        </div>\n        <div className=\"FaceEditor-Controls FaceEditor-Controls-Bottom\">\n          <input\n            type=\"range\"\n            className=\"FaceEditor-Controls-Scale\"\n            step=\"0.01\"\n            min=\"1\"\n            max=\"2\"\n            value={this.state.scale}\n            onChange={this.handleScale}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default FaceEditor;\n","import React from 'react';\nimport './App.css';\nimport FaceEditor, { Face } from './components/molecules/FaceEditor';\n\ntype AppProps = {};\n\ntype AppState = {\n  length: number;\n  length_text: string;\n  title: string;\n  previewing: boolean;\n  canDL: boolean;\n  downloadUrl: string;\n  fileName: string;\n  recording: boolean;\n  showCopyright: boolean;\n  editors: React.RefObject<FaceEditor>[];\n};\n\nconst CANVAS_WIDTH = 480;\nconst CANVAS_HEIGHT = 360;\n\nconst FACE_WIDTH = 150;\nconst FACE_HEIGHT = 270;\n\nconst DEFAULT_TITLE = 'エフエフジューヨン殺人事件';\n\nconst MAX_SCALE = 8;\n\nconst MSEC_BEFORE = 500;\nconst MSEC_FACE = 2200;\nconst MSEC_FADE = 800;\nconst MSEC_STOP = 3000;\nconst MSEC_AFTER = 500;\nconst MSEC_WHOLE = MSEC_BEFORE + MSEC_FACE + MSEC_FADE + MSEC_STOP + MSEC_AFTER;\n\nconst COPYRIGHT = 'Copyright (C) SQUARE ENIX CO., LTD. All Rights Reserved.';\n\nconst DEFAULT_LENGTH = 8;\n\ntype Position = {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n};\n\nfunction grayscale(data: Uint8ClampedArray) {\n  for (let i = 0; i < data.length; i += 4) {\n    const v = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];\n    // const v = (data[i] + data[i + 1] + data[i + 2]) / 3;\n    data[i] = v; // red\n    data[i + 1] = v; // green\n    data[i + 2] = v; // blue\n  }\n}\n\nfunction easeInCubic(x: number): number {\n  return x * x * x;\n}\n\nfunction calculateFadeRatio(elapsed: number): number {\n  if (elapsed <= MSEC_BEFORE || elapsed > MSEC_WHOLE - MSEC_AFTER) {\n    return -100;\n  } else if (elapsed <= MSEC_BEFORE + MSEC_FACE) {\n    return 0;\n  } else if (elapsed > MSEC_BEFORE + MSEC_FACE + MSEC_FADE) {\n    return 101;\n  } else {\n    const ratio = (elapsed - MSEC_FACE) / MSEC_FADE;\n    return easeInCubic(ratio) * 100;\n  }\n}\n\nclass App extends React.Component<AppProps, AppState> {\n  constructor(props: AppProps) {\n    super(props);\n    this.state = {\n      length: DEFAULT_LENGTH,\n      length_text: '' + DEFAULT_LENGTH,\n      title: '',\n      previewing: false,\n      canDL: false,\n      downloadUrl: '',\n      fileName: '',\n      recording: false,\n      showCopyright: true,\n      editors: Array.from({ length: DEFAULT_LENGTH }).map((_) =>\n        React.createRef<FaceEditor>()\n      ),\n    };\n    this.handleMemberLengthChange = this.handleMemberLengthChange.bind(this);\n    this.handleChangeTitle = this.handleChangeTitle.bind(this);\n    this.handleClickPreview = this.handleClickPreview.bind(this);\n    this.handleChangeCopyright = this.handleChangeCopyright.bind(this);\n    this.animate = this.animate.bind(this);\n  }\n\n  private canvasPreview: HTMLCanvasElement | null = null;\n  private ctxPreview: CanvasRenderingContext2D | null = null;\n  private canvasFace: HTMLCanvasElement | null = null;\n  private ctxFace: CanvasRenderingContext2D | null = null;\n  private canvasTitle: HTMLCanvasElement | null = null;\n  private ctxTitle: CanvasRenderingContext2D | null = null;\n\n  private startTime = -1;\n  private prevFadeRatio = -1;\n  private frameStartTime = -1;\n\n  private gifjs: GIF | null = null;\n  private dlImage = document.createElement('img');\n\n  componentDidMount() {\n    this.canvasPreview = document.querySelector(\n      '#Preview-Canvas'\n    ) as HTMLCanvasElement;\n    if (this.canvasPreview)\n      this.ctxPreview = this.canvasPreview.getContext('2d');\n    this.canvasFace = document.querySelector(\n      '#Preview-Canvas-Cache-Face'\n    ) as HTMLCanvasElement;\n    if (this.canvasFace) this.ctxFace = this.canvasFace.getContext('2d');\n    this.canvasTitle = document.querySelector(\n      '#Preview-Canvas-Cache-Title'\n    ) as HTMLCanvasElement;\n    if (this.canvasTitle) this.ctxTitle = this.canvasTitle.getContext('2d');\n  }\n\n  faceListClass(): string {\n    if (this.state.length <= 4) {\n      return 'FaceList-Max4';\n    }\n    if (this.state.length <= 6) {\n      return 'FaceList-Max3';\n    }\n    if (this.state.length <= 8) {\n      return 'FaceList-Max4';\n    }\n    return 'FaceList-Max5';\n  }\n\n  faceList(): JSX.Element[] {\n    return Array.from({ length: this.state.length }, (_, k) => k).map((key) => (\n      <FaceEditor\n        ref={this.state.editors[key]}\n        width={FACE_WIDTH}\n        height={FACE_HEIGHT}\n        key={key.toString()}\n      />\n    ));\n  }\n\n  handleChangeCopyright() {\n    this.setState((state) => ({\n      showCopyright: !state.showCopyright,\n    }));\n  }\n\n  handleMemberLengthChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const length_text = e.target.value || '';\n    let length = parseInt(length_text);\n    if (isNaN(length)) {\n      length = this.state.length;\n    } else {\n      if (length < 2) length = 2;\n      if (length > 8) length = 8;\n    }\n    this.setState((state) => {\n      if (length < state.editors.length) {\n        return { length, length_text, editors: state.editors.slice(0, length) };\n      } else if (length > state.editors.length) {\n        const editors: React.RefObject<FaceEditor>[] = state.editors.slice();\n        for (let i = state.editors.length; i < length; i++)\n          editors.push(React.createRef<FaceEditor>());\n        return { length, length_text, editors };\n      }\n      return { length, length_text, editors: state.editors.slice() };\n    });\n  }\n\n  handleChangeTitle(e: React.ChangeEvent<HTMLInputElement>) {\n    const title = e.target.value || '';\n    this.setState({ title });\n  }\n\n  handleClickPreview() {\n    if (!this.canvasPreview || !this.canvasFace || !this.canvasTitle) return;\n    // キャッシュ描画\n    this.drawFaceList();\n    this.drawTitle();\n    // 録画開始\n    this.gifjs = new GIF({\n      workerScript: 'js/gif.worker.js',\n      quality: 10,\n      workers: 2,\n      width: CANVAS_WIDTH,\n      height: CANVAS_HEIGHT,\n    });\n    // 描画開始\n    this.startTime = new Date().getTime();\n    this.frameStartTime = -1;\n    this.prevFadeRatio = -1;\n    requestAnimationFrame(this.animate);\n    // ステート更新\n    this.setState({\n      previewing: true,\n      downloadUrl: '',\n      fileName: '',\n      canDL: false,\n      recording: true,\n    });\n  }\n\n  addFrame(now: number): void {\n    if (!this.ctxPreview || !this.gifjs) return;\n    if (this.frameStartTime <= 0) {\n      this.frameStartTime = now;\n      return;\n    }\n    const delay = now - this.frameStartTime;\n    this.gifjs.addFrame(this.ctxPreview, { copy: true, delay });\n    this.frameStartTime = now;\n  }\n\n  saveGif(): void {\n    if (!this.gifjs) return;\n    const me = this;\n    this.gifjs.on('finished', function (blob: Blob) {\n      const url = URL.createObjectURL(blob);\n      me.dlImage.src = url;\n      me.setState({\n        downloadUrl: url,\n        fileName: (me.state.title || 'titlecall') + '.gif',\n        canDL: true,\n        recording: false,\n      });\n    });\n    this.gifjs.render();\n  }\n\n  animate(): void {\n    if (this.startTime < 0) return;\n    const now = new Date().getTime();\n    const elapsed = now - this.startTime;\n    // アニメーション終了\n    if (elapsed > MSEC_WHOLE) {\n      // フレーム追加\n      this.addFrame(now);\n      // 保存\n      this.saveGif();\n      return;\n    }\n    // アニメーション\n    const fadeRatio = calculateFadeRatio(elapsed);\n    //console.log(fadeRatio);\n    // フレームに変更があった場合、実際に描画\n    if (this.prevFadeRatio !== fadeRatio) {\n      // 前回フレームをGIFに追加\n      this.addFrame(now);\n      // 描画\n      this.drawFrame(fadeRatio);\n      // キャッシュの値を更新\n      this.prevFadeRatio = fadeRatio;\n    }\n    requestAnimationFrame(this.animate);\n  }\n\n  drawFrame(fadeRatio: number): void {\n    if (\n      !this.ctxPreview ||\n      !this.ctxFace ||\n      !this.ctxTitle ||\n      !this.canvasPreview ||\n      !this.canvasFace ||\n      !this.canvasTitle\n    )\n      return;\n    // black\n    if (fadeRatio < 0) {\n      this.ctxPreview.fillStyle = 'rgb(0, 0, 0)';\n      this.ctxPreview.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n      return;\n    }\n    // face\n    this.ctxPreview.globalAlpha = 1;\n    this.ctxPreview.drawImage(this.canvasFace, 0, 0);\n    if (fadeRatio < 1) return;\n    // title\n    if (fadeRatio > 100) {\n      this.ctxPreview.drawImage(this.canvasTitle, 0, 0);\n      return;\n    }\n    // scaled title\n    const ratio = fadeRatio * 0.01;\n    this.ctxPreview.globalAlpha = ratio + 0.1;\n    const scale = MAX_SCALE - ratio * (MAX_SCALE - 1);\n    const w = CANVAS_WIDTH * scale;\n    const h = CANVAS_HEIGHT * scale;\n    const x = ((w - CANVAS_WIDTH) / 2) * -1;\n    const y = ((h - CANVAS_HEIGHT) / 2) * -1;\n    this.ctxPreview.drawImage(\n      this.canvasTitle,\n      0,\n      0,\n      CANVAS_WIDTH,\n      CANVAS_HEIGHT,\n      x,\n      y,\n      w,\n      h\n    );\n  }\n\n  getFaceCanvases(): Face[] {\n    if (this.state.length !== this.state.editors.length) return [];\n    return this.state.editors.map((e) => {\n      if (!e.current) return { canvas: null, died: false };\n      return e.current.getFace();\n    });\n  }\n\n  getTitle(): string {\n    return '「' + (this.state.title || DEFAULT_TITLE) + '」';\n  }\n\n  calculatePosition(faces: Face[]): Position[] {\n    let h: number;\n    let w: number;\n    let _y = 0;\n    if (faces.length < 5) {\n      // 1段組 ... width基準\n      w = CANVAS_WIDTH / (faces.length + 1);\n      h = (FACE_HEIGHT * w) / FACE_WIDTH;\n      _y = (CANVAS_HEIGHT - h) / 2;\n    } else {\n      // 2段組 ... height基準\n      h = CANVAS_HEIGHT / 2;\n      w = (FACE_WIDTH * h) / FACE_HEIGHT;\n    }\n    const create = (x: number, y: number): Position[] =>\n      Array.from({ length: x }).map((_, i) => ({\n        x: (CANVAS_WIDTH - w * x) / 2 + (w + 1) * i,\n        y: y + _y,\n        w,\n        h,\n      }));\n    const ret: Position[] = [];\n    switch (faces.length) {\n      case 8:\n        ret.unshift(...create(4, h + 1));\n        ret.unshift(...create(4, 0));\n        break;\n      case 7:\n        ret.unshift(...create(3, h + 1));\n        ret.unshift(...create(4, 0));\n        break;\n      case 6:\n        ret.unshift(...create(3, h + 1));\n        ret.unshift(...create(3, 0));\n        break;\n      case 5:\n        ret.unshift(...create(2, h + 1));\n        ret.unshift(...create(3, 0));\n        break;\n      case 4:\n        ret.unshift(...create(4, 0));\n        break;\n      case 3:\n        ret.unshift(...create(3, 0));\n        break;\n      case 2:\n        ret.unshift(...create(2, 0));\n        break;\n    }\n    return ret;\n  }\n\n  drawFaceList(): void {\n    if (!this.ctxFace) return;\n    // get faces\n    const faces = this.getFaceCanvases();\n    if (faces.length !== this.state.length) return;\n    // calculate positions\n    const pos = this.calculatePosition(faces);\n    if (pos.length !== this.state.length) return;\n    // clear back\n    this.ctxFace.fillStyle = 'rgb(0, 0, 0)';\n    this.ctxFace.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    // draw grayscale\n    for (let i = 0; i < faces.length; i++) {\n      if (!faces[i].died) continue;\n      const c = faces[i].canvas;\n      if (!c) continue;\n      const p = pos[i];\n      this.ctxFace.drawImage(\n        c,\n        0,\n        0,\n        FACE_WIDTH,\n        FACE_HEIGHT,\n        p.x,\n        p.y,\n        p.w,\n        p.h\n      );\n    }\n    // grayscale filter\n    const img = this.ctxFace.getImageData(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    grayscale(img.data);\n    this.ctxFace.putImageData(img, 0, 0);\n    // black filter\n    this.ctxFace.globalAlpha = 0.5;\n    this.ctxFace.fillStyle = 'rgb(0, 0, 0)';\n    this.ctxFace.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    this.ctxFace.globalAlpha = 1;\n    // draw color\n    for (let i = 0; i < faces.length; i++) {\n      if (faces[i].died) continue;\n      const c = faces[i].canvas;\n      if (!c) continue;\n      const p = pos[i];\n      this.ctxFace.drawImage(\n        c,\n        0,\n        0,\n        FACE_WIDTH,\n        FACE_HEIGHT,\n        p.x,\n        p.y,\n        p.w,\n        p.h\n      );\n    }\n    // copyright\n    if (this.state.showCopyright) this.drawCopyright();\n  }\n\n  drawCopyright(): void {\n    if (!this.ctxFace) return;\n    this.ctxFace.lineJoin = 'round';\n    this.ctxFace.miterLimit = 3.0;\n    this.ctxFace.font =\n      \"12px 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif\";\n    this.ctxFace.textAlign = 'center';\n    this.ctxFace.lineWidth = 5;\n    this.ctxFace.strokeStyle = '#FFFFFF';\n    this.ctxFace.globalAlpha = 0.5;\n    this.ctxFace.strokeText(COPYRIGHT, CANVAS_WIDTH / 2, CANVAS_HEIGHT - 4);\n    this.ctxFace.lineWidth = 3;\n    this.ctxFace.strokeStyle = '#000000';\n    this.ctxFace.globalAlpha = 0.8;\n    this.ctxFace.strokeText(COPYRIGHT, CANVAS_WIDTH / 2, CANVAS_HEIGHT - 4);\n    this.ctxFace.fillStyle = '#FFFFFF';\n    this.ctxFace.globalAlpha = 1;\n    this.ctxFace.fillText(COPYRIGHT, CANVAS_WIDTH / 2, CANVAS_HEIGHT - 4);\n  }\n\n  getFont(fontSize: number): string {\n    return (\n      'bold ' +\n      fontSize +\n      \"px 'Times New Roman', 'YuMincho', 'Hiragino Mincho ProN', 'Yu Mincho', 'MS PMincho', 'Noto Serif JP', serif\"\n    );\n  }\n\n  getTextSize(ctx: CanvasRenderingContext2D, title: string): number {\n    let fontSize = Math.floor(CANVAS_WIDTH / (title.length - 2));\n    while (true) {\n      ctx.font = this.getFont(fontSize);\n      const w = ctx.measureText(title).width;\n      if (w < CANVAS_WIDTH) break;\n      fontSize--;\n    }\n    return fontSize;\n  }\n\n  drawTitle(): void {\n    if (!this.ctxTitle) return;\n    const title = this.getTitle();\n    const fontSize = this.getTextSize(this.ctxTitle, title);\n    this.ctxTitle.fillStyle = 'rgb(0, 0, 0)';\n    this.ctxTitle.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    this.ctxTitle.fillStyle = 'rgb(255, 255, 255)';\n    this.ctxTitle.font = this.getFont(fontSize);\n    this.ctxTitle.textAlign = 'center';\n    this.ctxTitle.fillText(title, CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <div className=\"GeneralControls\">\n          <table className=\"GeneralControls-ControlTable\">\n            <tbody>\n              <tr>\n                <th>\n                  <label htmlFor=\"num_of_suspects\">人数</label>\n                </th>\n                <td>\n                  <input\n                    type=\"number\"\n                    id=\"num_of_suspects\"\n                    min=\"2\"\n                    max=\"8\"\n                    value={String(this.state.length_text)}\n                    onChange={this.handleMemberLengthChange}\n                  />\n                  <span>（2～8人）</span>\n                </td>\n              </tr>\n              <tr>\n                <th>\n                  <label htmlFor=\"text_title\">タイトル</label>\n                </th>\n                <td>\n                  <input\n                    type=\"text\"\n                    id=\"text_title\"\n                    placeholder=\"エフエフジューヨン殺人事件\"\n                    value={this.state.title}\n                    onChange={this.handleChangeTitle}\n                  />\n                </td>\n              </tr>\n              {/* <tr>\n                <th>\n                  <label htmlFor=\"num_of_file\">ファイル</label>\n                </th>\n                <td>\n                  <input type=\"number\" id=\"num_of_file\" min=\"1\" max=\"99\" />\n                </td>\n              </tr> */}\n              <tr>\n                <td></td>\n                <td>\n                  <label id=\"GeneralControls-Copyright\">\n                    <input\n                      type=\"checkbox\"\n                      checked={this.state.showCopyright}\n                      onChange={this.handleChangeCopyright}\n                    />\n                    FFXIV権利表記を挿入する\n                  </label>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div className={'FaceList ' + this.faceListClass()}>\n          {this.faceList()}\n        </div>\n        <div className=\"Preview-Area\">\n          <button\n            className=\"Preview-Button\"\n            onClick={this.handleClickPreview}\n            disabled={this.state.recording}\n          >\n            生成\n          </button>\n          <canvas\n            id=\"Preview-Canvas\"\n            style={{ display: this.state.previewing ? 'block' : 'none' }}\n            width={CANVAS_WIDTH}\n            height={CANVAS_HEIGHT}\n          ></canvas>\n          <canvas\n            id=\"Preview-Canvas-Cache-Face\"\n            width={CANVAS_WIDTH}\n            height={CANVAS_HEIGHT}\n          ></canvas>\n          <canvas\n            id=\"Preview-Canvas-Cache-Title\"\n            width={CANVAS_WIDTH}\n            height={CANVAS_HEIGHT}\n          ></canvas>\n          <a\n            id=\"Preview-Canvas-Download-Link\"\n            style={{ display: this.state.canDL ? 'inline' : 'none' }}\n            href={this.state.downloadUrl}\n            download={this.state.fileName}\n          >\n            GIFをダウンロード\n          </a>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}